pipeline{
    agent none

    environment {
        function_name = 'javasampl'
    }

    stages{
        stage('Build') {
            agent {label 'master'}
            steps {
                echo 'build'
                 sh 'mvn package'
            }

        }
        stage('push') {
            agent {label 'master'}
            steps {
                echo 'push'

                sh "aws s3 cp target/bermtec-0.0.1.war s3://elasticbeanstalk-us-east-2-597671908319"
            }

        }
        stage('Deploy') {
            steps {
                echo 'prod'

                sh "aws lambda update-function-code --function-name $function_name --s3-bucket elasticbeanstalk-us-east-2-597671908319 --s3-key bermtec-0.0.1.war"
            }

        }
    

        }
}